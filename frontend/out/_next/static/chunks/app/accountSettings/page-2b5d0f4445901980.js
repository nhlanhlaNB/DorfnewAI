(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4015],{4755:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var n=a(5155),s=a(2115),i=a(63),r=a(6052),c=a(9708),o=a(2553),l=a(5115),u=a.n(l),d=a(4801);function p(){let e=(0,i.useRouter)(),[t,a]=(0,s.useState)(null),[l,p]=(0,s.useState)(null),[_,g]=(0,s.useState)(!0),[h,m]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let t=(0,o.hg)(r.j2,async t=>{if(!t)return void e.push("/login");a(t),await f(t.uid)});return()=>t()},[e]);let f=async e=>{try{g(!0);let t=await (0,c.x7)((0,c.H9)(r.db,"users",e));t.exists()&&p(t.data())}catch(e){console.error("Error fetching user data:",e)}finally{g(!1)}},S=async()=>{if(t&&confirm("Are you sure you want to cancel your subscription?"))try{m(!0);let e=await fetch("/api/paypal/cancel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:t.uid})});if(!e.ok){let{error:t}=await e.json();throw Error(t||"PayPal cancel request failed")}await (0,c.mZ)((0,c.H9)(r.db,"users",t.uid),{subscription:"free",subscriptionStatus:"cancelled",cancelledAt:new Date().toISOString()}),p({...l,subscription:"free",subscriptionStatus:"cancelled"}),alert("Your subscription has been cancelled.")}catch(e){console.error("Error cancelling subscription:",e),alert("Failed to cancel subscription. Try again.")}finally{m(!1)}},y=async()=>{if(t&&confirm("Resume your subscription?"))try{m(!0);let e=await fetch("/api/paypal/resume",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:t.uid})});if(!e.ok){let{error:t}=await e.json();throw Error(t||"PayPal resume request failed")}await (0,c.mZ)((0,c.H9)(r.db,"users",t.uid),{subscriptionStatus:"active"}),p({...l,subscriptionStatus:"active"}),alert("Your subscription has been resumed.")}catch(e){console.error("Error resuming subscription:",e),alert("Failed to resume subscription. Try again.")}finally{m(!1)}},b=async()=>{if(t&&confirm("Are you absolutely sure you want to permanently delete your account?"))try{m(!0),await (0,c.kd)((0,c.H9)(r.db,"users",t.uid)),await (0,o.hG)(t),alert("Your account has been deleted."),e.push("/")}catch(t){console.error("Error deleting account:",t),"auth/requires-recent-login"===t.code?(alert("Please log in again to delete your account."),e.push("/login")):alert("Failed to delete account. Try again.")}finally{m(!1)}};if(_)return(0,n.jsx)("div",{className:u().pageWrapper,children:(0,n.jsxs)("div",{className:u().loaderContainer,children:[(0,n.jsx)("div",{className:u().loader}),(0,n.jsx)("p",{children:"Loading your account information..."})]})});let j=(null==l?void 0:l.subscription)||"free",N=d.N.find(e=>e.key===j)||d.N.find(e=>"free"===e.key)||d.N[0];return(0,n.jsxs)("div",{className:u().pageWrapper,children:[(0,n.jsx)("header",{className:u().header,children:(0,n.jsx)("button",{className:u().closeButton,onClick:()=>e.push("/"),title:"Back to Home",children:(0,n.jsx)("i",{className:"fas fa-times"})})}),(0,n.jsxs)("main",{className:u().main,children:[(0,n.jsx)("h1",{className:u().pageTitle,children:"Manage Account"}),(0,n.jsxs)("div",{className:u().settingsContainer,children:[(0,n.jsxs)("div",{className:u().settingsCard,children:[(0,n.jsx)("h2",{className:u().cardTitle,children:"Subscription"}),(0,n.jsxs)("p",{children:["Current Plan: ",(0,n.jsx)("b",{children:N.title})]}),"free"!==j&&(null==l?void 0:l.subscriptionStatus)!=="cancelled"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:[N.price,"/month"]}),(0,n.jsx)("button",{className:u().cancelButton,onClick:S,disabled:h,children:h?"Processing...":"Cancel Subscription"})]}),(null==l?void 0:l.subscriptionStatus)==="cancelled"&&(0,n.jsx)("button",{className:u().actionButton,onClick:y,disabled:h,children:h?"Processing...":"Resume Subscription"}),"free"===j&&(null==l?void 0:l.subscriptionStatus)!=="cancelled"&&(0,n.jsx)("button",{className:u().actionButton,onClick:()=>e.push("/SubscriptionPage"),children:"Upgrade Plan"})]}),(0,n.jsxs)("div",{className:u().settingsCard,children:[(0,n.jsx)("h2",{className:u().cardTitle,children:"Danger Zone"}),(0,n.jsx)("p",{children:"Delete your account permanently. This cannot be undone."}),(0,n.jsx)("button",{className:u().deleteButton,onClick:b,disabled:h,children:h?"Deleting...":"Delete Account"})]})]})]})]})}},4801:(e,t,a)=>{"use strict";a.d(t,{N:()=>n});let n=[{title:"Standard",price:"$10",description:"Ideal for hobbyist creators who want to unlock the full potential of the platform.",features:["Unlimited generations","HD quality output","Priority processing","Access to all AI models","Save history for 30 days"],paypalPlanId:"P-4SW2058640943662UNBTJI6Y",seats:1},{title:"Pro",price:"$25",description:"Great for families or small groups, with shared access for up to 3 members.",features:["Everything in Standard","4K quality output","Express processing","Advanced editing tools","Commercial usage rights","Dedicated support"],paypalPlanId:"P-3CS59433TT1532629NBT25SQ",seats:4,popular:!0}]},5115:e=>{e.exports={pageWrapper:"accountSettings_pageWrapper__kMveu",header:"accountSettings_header__ePYsO",closeButton:"accountSettings_closeButton__BrOy7",main:"accountSettings_main__JnHZw",pageTitle:"accountSettings_pageTitle__rOMLr",pageSubtitle:"accountSettings_pageSubtitle__0zVAE",settingsContainer:"accountSettings_settingsContainer__Mxj7k",settingsCard:"accountSettings_settingsCard__0UIa_",cardTitle:"accountSettings_cardTitle__VA_om",cardDescription:"accountSettings_cardDescription__L4XMO",actionButton:"accountSettings_actionButton__2LZCq",cancelButton:"accountSettings_cancelButton__v68nI",footer:"accountSettings_footer__07DL9",profileInfo:"accountSettings_profileInfo__R6erD",subscriptionInfo:"accountSettings_subscriptionInfo__6nzJG",currentPlan:"accountSettings_currentPlan__eXtO_",planName:"accountSettings_planName__jKfDv",planPrice:"accountSettings_planPrice__7QOqR",planFeatures:"accountSettings_planFeatures__8ogO7",modalOverlay:"accountSettings_modalOverlay__WN7CZ",modal:"accountSettings_modal__t_bqk",plansContainer:"accountSettings_plansContainer__J3cgn",planOption:"accountSettings_planOption__7_Ppv",selected:"accountSettings_selected__sjFf9",modalActions:"accountSettings_modalActions__E0PFT",primaryButton:"accountSettings_primaryButton__9tmtD",secondaryButton:"accountSettings_secondaryButton__WOtnS",loaderContainer:"accountSettings_loaderContainer___f8u8",loader:"accountSettings_loader__kpHdF",spin:"accountSettings_spin__vs3wf"}},6052:(e,t,a)=>{"use strict";a.d(t,{db:()=>u,j2:()=>l,yA:()=>o});var n=a(2078),s=a(2553),i=a(9708),r=a(9996),c=a(4663);let o=(0,n.Wp)({apiKey:"AIzaSyCsUOwYavhzJsk3oa9utlxY7jAmmreGaO4",authDomain:"dorfnew-9f575.firebaseapp.com",projectId:"dorfnew-9f575",storageBucket:"dorfnew-9f575.firebasestorage.app",messagingSenderId:"690732549956",appId:"1:690732549956:web:b2199ce3f3b47924823911",measurementId:"G-CGFY15G69M"}),l=(0,s.xI)(o),u=(0,i.aU)(o);(0,r.c7)(o),(0,s.oM)(l,s.F0).catch(e=>{console.error("Error setting auth persistence:",e)}),(0,c.TT)().then(e=>e?(0,c.P5)(o):null)},9005:(e,t,a)=>{Promise.resolve().then(a.bind(a,4755))}},e=>{e.O(0,[1080,9135,3965,7849,1367,8441,1255,7358],()=>e(e.s=9005)),_N_E=e.O()}]);