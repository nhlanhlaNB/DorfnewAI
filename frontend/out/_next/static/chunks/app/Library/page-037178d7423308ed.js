(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2214],{1790:e=>{e.exports={libraryContainer:"Library_libraryContainer__z_zZh",gradientShift:"Library_gradientShift__qHXdg",star:"Library_star__aRdeX",moveStar:"Library_moveStar__1lveL",iconContainer:"Library_iconContainer__3J1CO",pulse:"Library_pulse__mu8So",error:"Library_error__JsQC3",searchBar:"Library_searchBar__kxbYz",searchIcon:"Library_searchIcon__VXy_2",searchInput:"Library_searchInput__gUXc2",emptyState:"Library_emptyState__2P9Kr",addButton:"Library_addButton__DiQZD",skeletonGrid:"Library_skeletonGrid__vCoI1",skeletonCard:"Library_skeletonCard__97nLT",skeletonPulse:"Library_skeletonPulse__L8Adp",mediaGrid:"Library_mediaGrid__6mHA9",mediaCard:"Library_mediaCard__84lcB",mediaActions:"Library_mediaActions__h8HeR",favoriteButton:"Library_favoriteButton__ANKXV",deleteButton:"Library_deleteButton__0Hs6Z",favorited:"Library_favorited__lOH3s",mediaContent:"Library_mediaContent__Y_VHj",audioPlaceholder:"Library_audioPlaceholder__ZhnkG",audioIcon:"Library_audioIcon__Ap3XC",mediaTitle:"Library_mediaTitle__0oIWe",mediaDate:"Library_mediaDate__zL6IX",downloadButton:"Library_downloadButton___nezI",exploreTopics:"Library_exploreTopics__qH8sQ",mediaDisplay:"Library_mediaDisplay__YISIv",topicsGrid:"Library_topicsGrid__oZf9j",topicCard:"Library_topicCard__o3Sjd",topicMusic:"Library_topicMusic__7_i6J",topicVideos:"Library_topicVideos__3S503",topicImages:"Library_topicImages__RN7Oq",closeButton:"Library_closeButton__1o2wm",previewModal:"Library_previewModal__9ZFHv",previewContent:"Library_previewContent__jYx50",closePreview:"Library_closePreview__7KVj9",previewMedia:"Library_previewMedia__BWkmp",modalOverlay:"Library_modalOverlay__1521Z",modal:"Library_modal__ANrIX",modalActions:"Library_modalActions__Nx2Py",modalButton:"Library_modalButton__a1OZQ",modalCancelButton:"Library_modalCancelButton__93_B9",loader:"Library_loader__vVhkA",spin:"Library_spin__p54CA"}},2820:(e,a,t)=>{Promise.resolve().then(t.bind(t,8674))},6052:(e,a,t)=>{"use strict";t.d(a,{db:()=>n,j2:()=>d,yA:()=>c});var i=t(2078),r=t(2553),o=t(9708),s=t(9996),l=t(4663);let c=(0,i.Wp)({apiKey:"AIzaSyCsUOwYavhzJsk3oa9utlxY7jAmmreGaO4",authDomain:"dorfnew-9f575.firebaseapp.com",projectId:"dorfnew-9f575",storageBucket:"dorfnew-9f575.firebasestorage.app",messagingSenderId:"690732549956",appId:"1:690732549956:web:b2199ce3f3b47924823911",measurementId:"G-CGFY15G69M"}),d=(0,r.xI)(c),n=(0,o.aU)(c);(0,s.c7)(c),(0,r.oM)(d,r.F0).catch(e=>{console.error("Error setting auth persistence:",e)}),(0,l.TT)().then(e=>e?(0,l.P5)(c):null)},8674:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>p});var i=t(5155),r=t(2115),o=t(63),s=t(6147),l=t(6052),c=t(9708),d=t(2553),n=t(5239),m=t(898),u=t(1790),_=t.n(u);function p(){let[e,a]=(0,r.useState)([]),[t,u]=(0,r.useState)(!0),[p,y]=(0,r.useState)(null),[b,h]=(0,r.useState)(null),[v,g]=(0,r.useState)(null),[x,f]=(0,r.useState)(null),[j,C]=(0,r.useState)(!1),[L,N]=(0,r.useState)(""),[w,I]=(0,r.useState)(null),k=(0,o.useRouter)(),A=[{type:"video",src:"https://videos.pexels.com/video-files/1519477/1519477-hd_1920_1080_30fps.mp4",title:"Nature Video 1"},{type:"video",src:"https://videos.pexels.com/video-files/3209298/3209298-hd_1920_1080_25fps.mp4",title:"Nature Video 2"},{type:"video",src:"https://videos.pexels.com/video-files/1409899/1409899-hd_1920_1080_30fps.mp4",title:"Nature Video 3"}],B=[{type:"image",src:"https://images.unsplash.com/photo-1507525428034-b723cf961d3e",title:"Image 1"},{type:"image",src:"https://pics.craiyon.com/2023-10-31/93234f8584254bf88c6d27430f35cba2.webp",title:"Image 2"},{type:"image",src:"https://png.pngtree.com/thumb_back/fh260/background/20240506/pngtree-a-boat-on-a-lake-in-autumn-image_15669075.jpg",title:"Image 3"}],S=[{type:"audio",src:"https://cdn.pixabay.com/audio/2023/03/20/audio_7c92e8b6df.mp3",title:"Instrumental Track 1"},{type:"audio",src:"https://cdn.pixabay.com/audio/2022/08/02/audio_34488e04fd.mp3",title:"Instrumental Track 2"},{type:"audio",src:"https://cdn.pixabay.com/audio/2023/10/25/audio_508e9b4631.mp3",title:"Instrumental Track 3"}];(0,r.useEffect)(()=>{let e=(0,d.hg)(l.j2,e=>{e?h(e):(console.error("No authenticated user found. Redirecting to login."),k.push("/login"))});return()=>e()},[k]),(0,r.useEffect)(()=>{b&&(async()=>{try{let e=(await (0,c.GG)((0,c.P)((0,c.rJ)(l.db,"library"),(0,c._M)("userId","==",b.uid)))).docs.map(e=>e.data().title);for(let a of[...A,...B,...S])if(!e.includes(a.title)){let e="".concat(b.uid,"_").concat(Date.now(),"_").concat(a.title.replace(/\s+/g,"_"));await (0,c.BN)((0,c.H9)(l.db,"library",e),{userId:b.uid,type:a.type,src:a.src,title:a.title,category:"image"===a.type?"Images":"video"===a.type?"Videos":"Music",createdAt:new Date,isFavorite:!1}),console.log("Stored hardcoded item: ".concat(a.title))}await D(),M()}catch(e){console.error("Error storing hardcoded media:",e.message),y("Failed to initialize library. Please try again.")}})()},[b]);let D=async()=>{if(b)try{let e=await (0,c.GG)((0,c.P)((0,c.rJ)(l.db,"library"),(0,c._M)("userId","==",b.uid))),a={image:"Images",video:"Videos",audio:"Music"};for(let t of e.docs){let e=t.data(),i={};!e.category&&e.type&&(i.category=a[e.type]),void 0===e.isFavorite&&(i.isFavorite=!1),Object.keys(i).length>0&&(await (0,c.BN)(t.ref,i,{merge:!0}),console.log("Updated document ".concat(t.id," with:"),i))}}catch(e){console.error("Error migrating library documents:",e.message)}},M=async()=>{try{u(!0),console.log("Fetching media for user:",null==b?void 0:b.uid,"category:",v);let e=(0,c.P)((0,c.rJ)(l.db,"library"),(0,c._M)("userId","==",null==b?void 0:b.uid),(0,c._M)("category",v?"==":"in",v||["Images","Videos","Music"]),(0,c.My)("createdAt","desc")),t=(await (0,c.GG)(e)).docs.map(e=>({id:e.id,type:e.data().type,src:e.data().src,title:e.data().title,createdAt:e.data().createdAt,category:e.data().category,isFavorite:e.data().isFavorite||!1})),i=L?t.filter(e=>e.title.toLowerCase().includes(L.toLowerCase())):t;console.log("Fetched ".concat(t.length," items, filtered to ").concat(i.length,' for search: "').concat(L,'"')),a(i),u(!1)}catch(e){console.error("Error fetching library items:",e.message),y("Failed to load library items. Please check your Firebase configuration or network connection."),u(!1)}};(0,r.useEffect)(()=>{b&&M()},[b,v,L]);let P=async(t,i)=>{if(!b)return void y("You must be logged in to favorite items.");try{await (0,c.mZ)((0,c.H9)(l.db,"library",t),{isFavorite:!i}),a(e.map(e=>e.id===t?{...e,isFavorite:!i}:e))}catch(e){console.error("Error toggling favorite:",e.message),y("Failed to update favorite status. Please try again.")}},F=async a=>{if(!b)return void y("You must be logged in to delete items.");let t=e.find(e=>e.id===a);console.log("Delete button clicked for item:",a,"Type:",null==t?void 0:t.type,"User:",b.uid),I(null),f(a)},G=async()=>{if(!x)return void console.log("No item selected for deletion");let t=e.find(e=>e.id===x);console.log("Confirming deletion for item:",x,"Category:",null==t?void 0:t.category);try{await (0,c.kd)((0,c.H9)(l.db,"library",x)),a(e.filter(e=>e.id!==x)),f(null),C(!0),console.log("Item deleted successfully:",x)}catch(e){console.error("Error deleting item:",x,"Details:",e.message),y("Failed to delete item. Please try again."),f(null)}},V=()=>{f(null),C(!1),I(null)},E=e=>{g(e)};return t?(0,i.jsxs)("div",{className:_().libraryContainer,children:[(0,i.jsx)("div",{className:_().iconContainer,children:(0,i.jsx)(m.vd0,{title:"Library","aria-label":"Library icon"})}),(0,i.jsx)("div",{className:_().loader}),(0,i.jsx)("p",{children:"Loading your library..."})]}):(0,i.jsxs)("div",{className:_().libraryContainer,children:[(0,i.jsx)("div",{className:_().iconContainer,children:(0,i.jsx)(m.vd0,{title:"Library","aria-label":"Library icon"})}),p&&(0,i.jsxs)("div",{className:_().error,children:[p,(0,i.jsx)("button",{onClick:()=>y(null),"aria-label":"Dismiss error",children:"Dismiss"})]}),x&&(0,i.jsx)("div",{className:_().modalOverlay,children:(0,i.jsxs)("div",{className:_().modal,children:[(0,i.jsx)("h3",{children:"Confirm Deletion"}),(0,i.jsx)("p",{children:"Are you sure you want to delete this item?"}),(0,i.jsxs)("div",{className:_().modalActions,children:[(0,i.jsx)("button",{className:_().modalButton,onClick:G,"aria-label":"Confirm delete",children:"Yes, Delete"}),(0,i.jsx)("button",{className:_().modalCancelButton,onClick:V,"aria-label":"Cancel delete",children:"Cancel"})]})]})}),j&&(0,i.jsx)("div",{className:_().modalOverlay,children:(0,i.jsxs)("div",{className:_().modal,children:[(0,i.jsx)("h3",{children:"Success"}),(0,i.jsx)("p",{children:"Item deleted successfully!"}),(0,i.jsx)("div",{className:_().modalActions,children:(0,i.jsx)("button",{className:_().modalButton,onClick:V,"aria-label":"Close success modal",children:"OK"})})]})}),w&&(0,i.jsx)("div",{className:_().previewModal,children:(0,i.jsxs)("div",{className:_().previewContent,children:[(0,i.jsx)("button",{className:_().closePreview,onClick:V,"aria-label":"Close preview",children:(0,i.jsx)(m.QCr,{})}),"image"===w.type&&(0,i.jsx)(n.default,{src:w.src,alt:w.title,className:_().previewMedia,width:800,height:600,unoptimized:!0}),"video"===w.type&&(0,i.jsx)("video",{className:_().previewMedia,controls:!0,src:w.src,title:w.title,autoPlay:!0}),"audio"===w.type&&(0,i.jsx)("audio",{className:_().previewMedia,controls:!0,src:w.src,title:w.title,autoPlay:!0}),(0,i.jsx)("h3",{children:w.title}),(0,i.jsx)("p",{children:w.createdAt?new Date(1e3*w.createdAt.seconds).toLocaleString():"Date not available"})]})}),(0,i.jsxs)("section",{className:_().searchBar,children:[(0,i.jsx)(m.KSO,{className:_().searchIcon}),(0,i.jsx)("input",{type:"text",placeholder:"Search by title...",value:L,onChange:e=>N(e.target.value),className:_().searchInput,"aria-label":"Search media items"})]}),(0,i.jsxs)("section",{className:_().exploreTopics,children:[(0,i.jsx)("h2",{children:"Explore Topics"}),(0,i.jsx)("div",{className:_().topicsGrid,children:[{name:"Music",color:"#7b68ee"},{name:"Videos",color:"#ff8e53"},{name:"Images",color:"#00ddeb"}].map(e=>(0,i.jsx)("div",{className:"".concat(_().topicCard," ").concat(_()["topic".concat(e.name.replace(/\s+/g,""))]),style:{background:e.color},onClick:()=>E(e.name),role:"button",tabIndex:0,onKeyDown:a=>"Enter"===a.key&&E(e.name),"aria-label":"Filter by ".concat(e.name),children:e.name},e.name))})]}),(0,i.jsxs)("section",{className:_().mediaDisplay,children:[(0,i.jsx)("h3",{children:"Media Library"}),0===e.length?(0,i.jsxs)("div",{className:_().emptyState,children:[(0,i.jsx)("h2",{children:"Your library is empty"}),(0,i.jsx)("p",{children:"Generate content to add videos, images, or audio to your library"}),(0,i.jsx)("button",{className:_().addButton,onClick:()=>{k.push("/dashboard")},"aria-label":"Generate new content",children:"Generate Your First Video, Image, or Audio"})]}):(0,i.jsx)("div",{className:_().mediaGrid,children:e.map(e=>(0,i.jsx)(s.A,{tiltMaxAngleX:15,tiltMaxAngleY:15,scale:1.05,transitionSpeed:400,children:(0,i.jsxs)("div",{className:_().mediaCard,onClick:()=>I(e),"aria-label":"View ".concat(e.title),children:[(0,i.jsxs)("div",{className:_().mediaActions,children:[(0,i.jsx)("button",{className:_().favoriteButton,onClick:a=>{a.stopPropagation(),P(e.id,e.isFavorite||!1)},"aria-label":e.isFavorite?"Remove from favorites":"Add to favorites",children:(0,i.jsx)(m.Mbv,{className:e.isFavorite?_().favorited:""})}),(0,i.jsx)("button",{className:_().deleteButton,onClick:a=>{a.stopPropagation(),F(e.id)},"aria-label":"Delete item",children:(0,i.jsx)(m.qbC,{})})]}),"image"===e.type&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.default,{src:e.src,alt:e.title,className:_().mediaContent,width:400,height:300,unoptimized:!0,loading:"eager"}),(0,i.jsx)("a",{href:e.src,download:"".concat(e.title,".jpg"),className:_().downloadButton,title:"Download ".concat(e.title),onClick:e=>e.stopPropagation(),"aria-label":"Download ".concat(e.title),children:"Download"})]}),"video"===e.type&&(0,i.jsx)("video",{className:_().mediaContent,src:e.src,title:e.title,muted:!0,style:{pointerEvents:"none"}}),"audio"===e.type&&(0,i.jsxs)("div",{className:_().audioPlaceholder,children:[(0,i.jsx)(m.Mbv,{className:_().audioIcon}),(0,i.jsx)("p",{children:e.title})]}),(0,i.jsx)("p",{className:_().mediaTitle,children:e.title}),(0,i.jsx)("p",{className:_().mediaDate,children:e.createdAt?new Date(1e3*e.createdAt.seconds).toLocaleString():"Date not available"})]})},e.id))}),v&&(0,i.jsx)("button",{className:_().closeButton,onClick:()=>{g(null)},"aria-label":"Close category filter",children:"Close"})]})]})}}},e=>{e.O(0,[5729,9135,3965,6711,7849,1367,5239,4826,8441,1255,7358],()=>e(e.s=2820)),_N_E=e.O()}]);